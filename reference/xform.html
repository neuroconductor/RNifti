<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Obtain or replace the ``xform'' transforms for an image — xform • RNifti</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Obtain or replace the ``xform'' transforms for an image — xform" />
<meta property="og:description" content="These functions convert the ``qform'' or ``sform'' information in a NIfTI
header to or from a corresponding affine matrix. These two ``xform''
mechanisms are defined by the NIfTI standard, and may both be in use in a
particular image header. They define the relationship between the storage
order of the image and real space." />






<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->




  

  

  </head>

  <body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">RNifti</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.3.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/jonclayden/RNifti/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Obtain or replace the ``xform'' transforms for an image</h1>
    <small class="dont-index">Source: <a href='https://github.com/jonclayden/RNifti/blob/master/R/xform.R'><code>R/xform.R</code></a></small>
    <div class="hidden name"><code>xform.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>These functions convert the ``qform'' or ``sform'' information in a NIfTI
header to or from a corresponding affine matrix. These two ``xform''
mechanisms are defined by the NIfTI standard, and may both be in use in a
particular image header. They define the relationship between the storage
order of the image and real space.</p>
    </div>

    <div class="ref-usage sourceCode"><pre class='sourceCode r'><code><span class='fu'>xform</span><span class='op'>(</span><span class='va'>image</span>, useQuaternionFirst <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>

<span class='fu'>qform</span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='va'>value</span>

<span class='fu'>sform</span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='va'>value</span>

<span class='fu'>orientation</span><span class='op'>(</span><span class='va'>x</span>, useQuaternionFirst <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>

<span class='fu'>orientation</span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='va'>value</span>

<span class='fu'>rotation</span><span class='op'>(</span><span class='va'>x</span>, useQuaternionFirst <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span></code></pre></div>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>image, x</th>
      <td><p>An image, in any acceptable form (see <code><a href='asNifti.html'>asNifti</a></code>),
or a 4x4 numeric xform matrix.</p></td>
    </tr>
    <tr>
      <th>useQuaternionFirst</th>
      <td><p>A single logical value. If <code>TRUE</code>, the
``qform'' matrix will be used first, if it is defined; otherwise the
``sform'' matrix will take priority.</p></td>
    </tr>
    <tr>
      <th>value</th>
      <td><p>A new 4x4 qform or sform matrix, or orientation string. If a
matrix has a <code>"code"</code> attribute, the appropriate qform or sform code
is also set.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>For <code>xform</code>, an affine matrix corresponding to the ``qform''
  or ``sform'' information in the image header, with a <code>"code"</code>
  attribute giving the corresponding xform code. For <code>orientation</code>, a
  string with three characters indicating the (approximate) orientation of
  the image. The replacement forms return the modified object.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Image orientation is indicated using a three-character string, with each
character indicating the approximate world-space direction of the positive
axes in the first, second and third dimensions, in order. Each character may
be `R' for left-to-right, `L' for right-to-left, `A' for posterior-to-
anterior, `P' for anterior-to-posterior, `S' for inferior-to-superior, or
`I' for superior-to-inferior. The default for NIfTI is RAS, meaning that the
first dimension points towards the right, the second towards the front and
the third towards the top. An xform matrix is an affine transform relative
to that default.</p>
<p>The upper-left 3x3 matrix in a 3D affine transform governs scale, rotation
and skew, while the last column is a translation. (The <code>rotation</code>
function extracts the rotation part alone.) The final row is always
(0,0,0,1). Reorienting an image involves permuting and possibly reversing
some of the axes, both in the data and the metadata. The sense of the
translation may also need to be reversed, but this is only possible if the
image dimensions are known, which isn't the case when reorienting an xform
alone.</p>
    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p>The qform and sform replacement functions are for advanced users only.
  Modifying the transforms without knowing what you're doing is usually
  unwise, as you can make the image object inconsistent.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>The NIfTI-1 standard (<a href='https://www.nitrc.org/docman/view.php/26/64/nifti1.h'>https://www.nitrc.org/docman/view.php/26/64/nifti1.h</a>)
  is the definitive reference on ``xform'' conventions.</p>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Jon Clayden &lt;code@clayden.org&gt;</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <div class="ref-examples sourceCode"><pre class='sourceCode r'><code><span class='r-in'><span class='va'>im</span> <span class='op'>&lt;-</span> <span class='fu'><a href='readNifti.html'>readNifti</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/system.file.html'>system.file</a></span><span class='op'>(</span><span class='st'>"extdata"</span>, <span class='st'>"example.nii.gz"</span>, package<span class='op'>=</span><span class='st'>"RNifti"</span><span class='op'>)</span><span class='op'>)</span></span>
<span class='r-in'><span class='fu'>xform</span><span class='op'>(</span><span class='va'>im</span><span class='op'>)</span></span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>      [,1] [,2] [,3]      [,4]</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> [1,] -2.5  0.0  0.0 122.03390</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> [2,]  0.0  2.5  0.0 -95.18523</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> [3,]  0.0  0.0  2.5 -55.03814</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> [4,]  0.0  0.0  0.0   1.00000</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> attr(,"code")</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> [1] 2</span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># Remove the qform information</span></span>
<span class='r-in'><span class='fu'>qform</span><span class='op'>(</span><span class='va'>im</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/structure.html'>structure</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/diag.html'>diag</a></span><span class='op'>(</span><span class='fl'>4</span><span class='op'>)</span>, code<span class='op'>=</span><span class='fl'>0L</span><span class='op'>)</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># The same as above, since the sform is unmodified</span></span>
<span class='r-in'><span class='fu'>xform</span><span class='op'>(</span><span class='va'>im</span><span class='op'>)</span></span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>      [,1] [,2] [,3]      [,4]</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> [1,] -2.5  0.0  0.0 122.03390</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> [2,]  0.0  2.5  0.0 -95.18523</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> [3,]  0.0  0.0  2.5 -55.03814</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> [4,]  0.0  0.0  0.0   1.00000</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> attr(,"code")</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> [1] 2</span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># The identity matrix corresponds to RAS orientation</span></span>
<span class='r-in'><span class='fu'>orientation</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/diag.html'>diag</a></span><span class='op'>(</span><span class='fl'>4</span><span class='op'>)</span><span class='op'>)</span></span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> [1] "RAS"</span>
<span class='r-in'></span>
</code></pre></div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p><p>Developed by Jon Clayden, Bob Cox, Mark Jenkinson.</p></p>
</div>

<div class="pkgdown">
  <p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 1.6.1.9001.</p></p>
</div>

      </footer>
   </div>

  


  

  </body>
</html>


